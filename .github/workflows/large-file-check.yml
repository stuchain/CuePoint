name: Large File Check

on:
  push:
    branches: [main, 'phase_*']
  pull_request:
    branches: [main]

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: Check for large files
        run: |
          python scripts/check_large_files.py
      
      - name: Check git-tracked large files
        run: |
          # Check files already tracked by git
          git ls-files -z | xargs -0 -I {} sh -c 'test -f "{}" && stat -f%z "{}" 2>/dev/null || stat -c%s "{}" 2>/dev/null || echo 0' | \
          awk '{if ($1 > 52428800) print "Large tracked file detected"}'
